<html>

<head>
    <link href="../css/main.css" rel="stylesheet" type="text/css">
</head>

<body>
    <div class="site">
        <div class="left">
        </div>
        <div class="right">
        </div>
        <div class=" slots">
            <div class="reel1">
                <div class="symbol_0_-1_" id="symbol_0_-1_">
                </div>
                <div class="symbol_0_0_" id="symbol_0_0_">
                </div>
                <div class="symbol_0_1_" id="symbol_0_1_">
                </div>
                <div class="symbol_0_2_" id="symbol_0_2_">
                </div>
            </div>
            <div class="reel2">
                <div class="symbol_1_-1_" id="symbol_1_-1_">
                </div>
                <div class="symbol_1_0_" id="symbol_1_0_">
                </div>
                <div class="symbol_1_1_" id="symbol_1_1_">
                </div>
                <div class="symbol_1_2_" id="symbol_1_2_">
                </div>
            </div>
            <div class="reel3">
                <div class="symbol_2_-1_" id="symbol_2_-1_">
                </div>
                <div class="symbol_2_0_" id="symbol_2_0_">
                </div>
                <div class="symbol_2_1_" id="symbol_2_1_">
                </div>
                <div class="symbol_2_2_" id="symbol_2_2_">
                </div>
            </div>
            <div class="reel4">
                <div class="symbol_3_-1_" id="symbol_3_-1_">
                </div>
                <div class="symbol_3_0_" id="symbol_3_0_">
                </div>
                <div class="symbol_3_1_" id="symbol_3_1_">
                </div>
                <div class="symbol_3_2_" id="symbol_3_2_">
                </div>
            </div>
            <div class="reel5">
                <div class="symbol_4_-1_" id="symbol_4_-1_">
                </div>
                <div class="symbol_4_0_" id="symbol_4_0_">
                </div>
                <div class="symbol_4_1_" id="symbol_4_1_">
                </div>
                <div class="symbol_4_2_" id="symbol_4_2_">
                </div>
            </div>

        </div>
        <div class="bottom-block">
            <div class="betButton" id="betButton"></div>
            <div class="spinButton" id="spinButton"></div>
            <div class="autoplayButton" id="autoplayButton"></div>
        </div>
        <div class="top-block">
            blech
        </div>
    </div>
</body>
<script>
    var allReels = new Array();
    var originalYValues = ['-33.33%', '0%', '33.33%', '66.66%'];
    for (var reel = 0; reel < 5; reel++) {
        allReels[reel] = new Array();
        for (var row = -1; row < 3; row++) {
            var symID = "symbol" + "_" + reel + "_" + row + "_";
            allReels[reel][row] = symID;
            var rand = Math.floor(Math.random() * (19 - 1 + 1) + 1);
            document.getElementById(allReels[reel][row]).style.backgroundImage = "url('../assets/symbols/" + rand +
                ".jpeg')";

        }
    }

    var betButton = document.getElementById("betButton");
    var spinButton = document.getElementById("spinButton");
    var autoplayButton = document.getElementById("autoplayButton");

    spinButton.addEventListener("click", spinButtonClicked);

    var singleSpinDuration = 0.2;
    var totalSpinDuration = 2;
    var resolveTime = 1;
    var totalResolveTime = resolveTime;

    function spinButtonClicked() {

        for (var reel = 0; reel < 5; reel++) {
            var time = singleSpinDuration;
            var originalTime = time;
            for (var row = -1; row < 3; row++) {
                var sym = document.getElementById(allReels[reel][row].toString());
                sym.addEventListener("webkitAnimationEnd", moveUpSymbol);
                sym.style.animationName = "spinsymbol_0_" + row + "_";
                sym.style.animationTimingFunction = "linear";
                sym.style.animationDuration = time + "s";
                sym.style.animationPlayState = "running";
                time = time - (originalTime * 0.25);
            }
        }
    }

    function moveUpSymbol() {
        this.removeEventListener("webkitAnimationEnd", moveUpSymbol);
        this.style.top = "-33.33%";
        this.style.animationName = "genericSymbolSpin";
        this.style.animationDuration = singleSpinDuration + "s";
        this.style.animationPlayState = "running";
        var iterationCount = Math.round(totalSpinDuration / singleSpinDuration);
        this.style.animationIterationCount = iterationCount.toString();
        this.addEventListener("webkitAnimationEnd", resolveSymbol);
    }

    function resolveSymbol() {
        resolveTime = 0 + (totalResolveTime * 0.25);
        this.removeEventListener("webkitAnimationEnd", resolveSymbol);
        this.style.animationDuration = resolveTime + "s";
        this.style.animationTimingFunction = "linear";
        var animName = this.id.toString().split('_');
        this.style.animationName = "resolvesymbol_0_" + animName[2] + "_";
        this.style.animationPlayState = "running";
        this.style.animationIterationCount = 1;
        this.style.animationFillMode = "forwards";
        var rand = Math.floor(Math.random() * (19 - 1 + 1) + 1);
        document.getElementById(allReels[animName[1]][animName[2]]).style.backgroundImage = "url('../assets/symbols/" +
            rand +
            ".jpeg')";
    }
</script>

</html>